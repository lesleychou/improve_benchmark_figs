[
    {
        "llm_command": "",
        "output": "",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl get networkpolicy -n checkoutservice -o yaml",
        "output": "apiVersion: v1\nitems:\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"allow-checkout-to-email\",\"namespace\":\"checkoutservice\"},\"spec\":{\"egress\":[{\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Egress\"]}}\n    creationTimestamp: \"2025-04-26T20:17:35Z\"\n    generation: 2\n    name: allow-checkout-to-email\n    namespace: checkoutservice\n    resourceVersion: \"83122\"\n    uid: a30590e3-7605-44c6-a87d-d135e5cc9da7\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"allow-emailservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"namespaceSelector\":{\"matchLabels\":{\"name\":\"emailservice\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T05:14:04Z\"\n    generation: 208\n    name: allow-emailservice\n    namespace: checkoutservice\n    resourceVersion: \"61532\"\n    uid: a517010a-d0ba-4f78-9419-d33d2040da63\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Egress\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"allow-frontend-to-checkoutservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"frontend\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:34:10Z\"\n    generation: 4\n    name: allow-frontend-to-checkoutservice\n    namespace: checkoutservice\n    resourceVersion: \"55962\"\n    uid: 0d91e82c-1ddc-4c48-93fc-0185b80d0d1b\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      ports:\n      - port: 5050\n        protocol: TCP\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkout-allow\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T16:38:12Z\"\n    generation: 1\n    name: checkout-allow\n    namespace: checkoutservice\n    resourceVersion: \"58710\"\n    uid: 0ccd331d-359b-45fc-ab2a-42b079472411\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkout-allow-egress\",\"namespace\":\"checkoutservice\"},\"spec\":{\"egress\":[{\"ports\":[{\"port\":7070,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"cartservice\"}}}]},{\"ports\":[{\"port\":7000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}]},{\"ports\":[{\"port\":3550,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"productcatalogservice\"}}}]},{\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}}]},{\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]},{\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}]}],\"podSelector\":{},\"policyTypes\":[\"Egress\"]}}\n    creationTimestamp: \"2025-04-26T19:12:01Z\"\n    generation: 5\n    name: checkout-allow-egress\n    namespace: checkoutservice\n    resourceVersion: \"75472\"\n    uid: 4873d70f-d795-426a-a467-39fdb43ec411\n  spec:\n    egress:\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 3550\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    podSelector: {}\n    policyTypes:\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}],\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T05:14:26Z\"\n    generation: 108\n    name: checkoutservice\n    namespace: checkoutservice\n    resourceVersion: \"91045\"\n    uid: d4e51602-4b97-4a4c-a15d-12b49b9a18aa\n  spec:\n    egress:\n    - to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 3550\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}],\"ports\":[{\"port\":7000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:22:22Z\"\n    generation: 19\n    name: checkoutservice-allow\n    namespace: checkoutservice\n    resourceVersion: \"71886\"\n    uid: 6258d6f5-d130-4dff-93ea-4de5919aba36\n  spec:\n    egress:\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n      ports:\n      - port: 7070\n        protocol: TCP\n      - port: 7000\n        protocol: TCP\n      - port: 3550\n        protocol: TCP\n      - port: 50051\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-cart\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"cartservice\"}}}],\"ports\":[{\"port\":7070,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:43Z\"\n    generation: 11\n    name: checkoutservice-allow-cart\n    namespace: checkoutservice\n    resourceVersion: \"70269\"\n    uid: a33816b5-e427-4c65-aec1-377025327d23\n  spec:\n    egress:\n    - ports:\n      - port: 7070\n        protocol: TCP\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      ports:\n      - port: 7070\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-currency\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}],\"ports\":[{\"port\":7000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:39Z\"\n    generation: 1\n    name: checkoutservice-allow-currency\n    namespace: checkoutservice\n    resourceVersion: \"29146\"\n    uid: 6c93dfcc-c43f-460e-84d8-763b2194e2de\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n      ports:\n      - port: 7000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-email\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:57Z\"\n    generation: 14\n    name: checkoutservice-allow-email\n    namespace: checkoutservice\n    resourceVersion: \"82250\"\n    uid: 6d09b99f-d5b5-4a9f-b0d8-5412c98a1412\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-payment\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}],\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:43:03Z\"\n    generation: 1\n    name: checkoutservice-allow-payment\n    namespace: checkoutservice\n    resourceVersion: \"29181\"\n    uid: 5d994fda-6ee9-4716-bed2-a42c184e1599\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n      ports:\n      - port: 50051\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-productcatalog\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"productcatalogservice\"}}}],\"ports\":[{\"port\":3550,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:48Z\"\n    generation: 1\n    name: checkoutservice-allow-productcatalog\n    namespace: checkoutservice\n    resourceVersion: \"29161\"\n    uid: ffa083e8-5c90-4766-89f2-9464711a9be3\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      ports:\n      - port: 3550\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-shipping\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}}],\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:53Z\"\n    generation: 1\n    name: checkoutservice-allow-shipping\n    namespace: checkoutservice\n    resourceVersion: \"29166\"\n    uid: a2e9d0fe-778a-43e3-ab22-0bb1e7bd786b\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      ports:\n      - port: 50051\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-policy\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"frontend\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T05:54:43Z\"\n    generation: 436\n    name: checkoutservice-policy\n    namespace: checkoutservice\n    resourceVersion: \"91335\"\n    uid: 03b4d641-8e35-44eb-a912-db6a1be9b964\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      - podSelector:\n          matchLabels:\n            app: payment\n      - podSelector:\n          matchLabels:\n            app: shipping\n      - podSelector:\n          matchLabels:\n            app: email\n      - podSelector:\n          matchLabels:\n            app: currency\n      - namespaceSelector:\n          matchLabels:\n            name: adservice\n        podSelector:\n          matchLabels:\n            app: adservice\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-ad-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"adservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T19:45:57Z\"\n    generation: 10\n    name: deny-ad-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"86164\"\n    uid: bf773c50-50f9-4fb2-806d-2e34948ad599\n  spec:\n    egress:\n    - ports:\n      - port: 9555\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: adservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: adservice\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-adservice-to-checkoutservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"adservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T21:27:36Z\"\n    generation: 2\n    name: deny-adservice-to-checkoutservice\n    namespace: checkoutservice\n    resourceVersion: \"82703\"\n    uid: 3c7bdd35-7e44-4a32-9352-021f09c51594\n  spec:\n    ingress:\n    - ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-all-ingress-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T11:45:36Z\"\n    generation: 15\n    name: deny-all-ingress-checkout\n    namespace: checkoutservice\n    resourceVersion: \"82304\"\n    uid: 41c4a56d-e5d9-418b-b2a8-2680b3e3b23e\n  spec:\n    egress:\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-cart-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"cartservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T19:46:01Z\"\n    generation: 1\n    name: deny-cart-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"74006\"\n    uid: e4a68616-5a71-4bec-aece-0f0aba0bb43a\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-productcatalog-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"productcatalogservice\"}}}],\"ports\":[{\"port\":5050}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T11:45:32Z\"\n    generation: 1\n    name: deny-productcatalog-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"34445\"\n    uid: b9508333-8263-4000-a400-0c2a6ca21c09\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-recommendation-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"recommendationservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T13:00:47Z\"\n    generation: 7\n    name: deny-recommendation-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"90827\"\n    uid: e99e9682-85d8-4761-bc92-4ecb1ae02bc9\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: recommendationservice\n      ports:\n      - port: 8080\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-shipping-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T11:46:00Z\"\n    generation: 11\n    name: deny-shipping-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"90770\"\n    uid: fe4752a4-613e-446b-860e-50d7fa7c6d78\n  spec:\n    egress:\n    - ports:\n      - port: 5050\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      ports:\n      - port: 5050\n        protocol: TCP\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\nkind: List\nmetadata:\n  resourceVersion: \"\"\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "bash\nkubectl patch networkpolicy allow-checkout-to-email -n checkoutservice --type='json' -p='[{\"op\": \"add\", \"path\": \"/spec/egress/0/to/0/podSelector/matchLabels\", \"value\": {\"app\": \"emailservice\"}},{\"op\": \"add\", \"path\": \"/spec/egress/0/ports/0\", \"value\": {\"port\": 5000, \"protocol\": \"TCP\"}}]'",
        "output": "networkpolicy.networking.k8s.io/allow-checkout-to-email patched\n",
        "mismatch_summary": "Mismatch: frontend \u2192 adservice:9555 (Expected: True, Actual: False)\nMismatch: frontend \u2192 cartservice:7070 (Expected: True, Actual: False)\nMismatch: frontend \u2192 checkoutservice:5050 (Expected: True, Actual: False)\nMismatch: frontend \u2192 currencyservice:7000 (Expected: True, Actual: False)\nMismatch: frontend \u2192 productcatalogservice:3550 (Expected: True, Actual: False)\nMismatch: frontend \u2192 recommendationservice:8080 (Expected: True, Actual: False)\nMismatch: frontend \u2192 shippingservice:50051 (Expected: True, Actual: False)\nMismatch: cartservice \u2192 redis-cart:6379 (Expected: True, Actual: False)\nMismatch: checkoutservice \u2192 cartservice:7070 (Expected: True, Actual: False)\nMismatch: checkoutservice \u2192 currencyservice:7000 (Expected: True, Actual: False)\nMismatch: checkoutservice \u2192 productcatalogservice:3550 (Expected: True, Actual: False)\nMismatch: checkoutservice \u2192 shippingservice:50051 (Expected: True, Actual: False)\nMismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: checkoutservice \u2192 paymentservice:50051 (Expected: True, Actual: False)\nMismatch: recommendationservice \u2192 productcatalogservice:3550 (Expected: True, Actual: False)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl patch networkpolicy allow-checkout-to-email -n checkoutservice --type='json' -p='[{\"op\": \"replace\", \"path\": \"/spec/egress/0/to\", \"value\": [{\"podSelector\": {\"matchLabels\": {\"app\": \"emailservice\"}}}]},{\"op\": \"replace\", \"path\": \"/spec/egress/0/ports\", \"value\": [{\"port\": 5000, \"protocol\": \"TCP\"}]}]'",
        "output": "networkpolicy.networking.k8s.io/allow-checkout-to-email patched\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl patch networkpolicy allow-checkout-to-email -n checkoutservice --type='json' -p='[{\"op\": \"add\", \"path\": \"/spec/egress/0/to/-\", \"value\": {\"podSelector\": {\"matchLabels\": {\"app\": \"emailservice\"}}}},{\"op\": \"add\", \"path\": \"/spec/egress/0/ports/-\", \"value\": {\"port\": 5000, \"protocol\": \"TCP\"}}]'",
        "output": "networkpolicy.networking.k8s.io/allow-checkout-to-email patched\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl get networkpolicy -n checkoutservice -o yaml",
        "output": "apiVersion: v1\nitems:\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"allow-checkout-to-email\",\"namespace\":\"checkoutservice\"},\"spec\":{\"egress\":[{\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Egress\"]}}\n    creationTimestamp: \"2025-04-26T20:17:35Z\"\n    generation: 5\n    name: allow-checkout-to-email\n    namespace: checkoutservice\n    resourceVersion: \"91628\"\n    uid: a30590e3-7605-44c6-a87d-d135e5cc9da7\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"allow-emailservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"namespaceSelector\":{\"matchLabels\":{\"name\":\"emailservice\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T05:14:04Z\"\n    generation: 208\n    name: allow-emailservice\n    namespace: checkoutservice\n    resourceVersion: \"61532\"\n    uid: a517010a-d0ba-4f78-9419-d33d2040da63\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Egress\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"allow-frontend-to-checkoutservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"frontend\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:34:10Z\"\n    generation: 4\n    name: allow-frontend-to-checkoutservice\n    namespace: checkoutservice\n    resourceVersion: \"55962\"\n    uid: 0d91e82c-1ddc-4c48-93fc-0185b80d0d1b\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      ports:\n      - port: 5050\n        protocol: TCP\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkout-allow\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T16:38:12Z\"\n    generation: 1\n    name: checkout-allow\n    namespace: checkoutservice\n    resourceVersion: \"58710\"\n    uid: 0ccd331d-359b-45fc-ab2a-42b079472411\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkout-allow-egress\",\"namespace\":\"checkoutservice\"},\"spec\":{\"egress\":[{\"ports\":[{\"port\":7070,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"cartservice\"}}}]},{\"ports\":[{\"port\":7000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}]},{\"ports\":[{\"port\":3550,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"productcatalogservice\"}}}]},{\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}}]},{\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]},{\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}]}],\"podSelector\":{},\"policyTypes\":[\"Egress\"]}}\n    creationTimestamp: \"2025-04-26T19:12:01Z\"\n    generation: 5\n    name: checkout-allow-egress\n    namespace: checkoutservice\n    resourceVersion: \"75472\"\n    uid: 4873d70f-d795-426a-a467-39fdb43ec411\n  spec:\n    egress:\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 3550\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    podSelector: {}\n    policyTypes:\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}],\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T05:14:26Z\"\n    generation: 108\n    name: checkoutservice\n    namespace: checkoutservice\n    resourceVersion: \"91045\"\n    uid: d4e51602-4b97-4a4c-a15d-12b49b9a18aa\n  spec:\n    egress:\n    - to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 3550\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}],\"ports\":[{\"port\":7000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:22:22Z\"\n    generation: 19\n    name: checkoutservice-allow\n    namespace: checkoutservice\n    resourceVersion: \"71886\"\n    uid: 6258d6f5-d130-4dff-93ea-4de5919aba36\n  spec:\n    egress:\n    - ports:\n      - port: 7000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n      ports:\n      - port: 7070\n        protocol: TCP\n      - port: 7000\n        protocol: TCP\n      - port: 3550\n        protocol: TCP\n      - port: 50051\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-cart\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"cartservice\"}}}],\"ports\":[{\"port\":7070,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:43Z\"\n    generation: 11\n    name: checkoutservice-allow-cart\n    namespace: checkoutservice\n    resourceVersion: \"70269\"\n    uid: a33816b5-e427-4c65-aec1-377025327d23\n  spec:\n    egress:\n    - ports:\n      - port: 7070\n        protocol: TCP\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      ports:\n      - port: 7070\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-currency\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}],\"ports\":[{\"port\":7000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:39Z\"\n    generation: 1\n    name: checkoutservice-allow-currency\n    namespace: checkoutservice\n    resourceVersion: \"29146\"\n    uid: 6c93dfcc-c43f-460e-84d8-763b2194e2de\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: currencyservice\n      ports:\n      - port: 7000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-email\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:57Z\"\n    generation: 14\n    name: checkoutservice-allow-email\n    namespace: checkoutservice\n    resourceVersion: \"82250\"\n    uid: 6d09b99f-d5b5-4a9f-b0d8-5412c98a1412\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-payment\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}],\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:43:03Z\"\n    generation: 1\n    name: checkoutservice-allow-payment\n    namespace: checkoutservice\n    resourceVersion: \"29181\"\n    uid: 5d994fda-6ee9-4716-bed2-a42c184e1599\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n      ports:\n      - port: 50051\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-productcatalog\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"productcatalogservice\"}}}],\"ports\":[{\"port\":3550,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:48Z\"\n    generation: 1\n    name: checkoutservice-allow-productcatalog\n    namespace: checkoutservice\n    resourceVersion: \"29161\"\n    uid: ffa083e8-5c90-4766-89f2-9464711a9be3\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      ports:\n      - port: 3550\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-allow-shipping\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}}],\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T10:42:53Z\"\n    generation: 1\n    name: checkoutservice-allow-shipping\n    namespace: checkoutservice\n    resourceVersion: \"29166\"\n    uid: a2e9d0fe-778a-43e3-ab22-0bb1e7bd786b\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      ports:\n      - port: 50051\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"checkoutservice-policy\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"frontend\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"currencyservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T05:54:43Z\"\n    generation: 436\n    name: checkoutservice-policy\n    namespace: checkoutservice\n    resourceVersion: \"91335\"\n    uid: 03b4d641-8e35-44eb-a912-db6a1be9b964\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    - to:\n      - podSelector:\n          matchLabels:\n            app: emailservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      - podSelector:\n          matchLabels:\n            app: payment\n      - podSelector:\n          matchLabels:\n            app: shipping\n      - podSelector:\n          matchLabels:\n            app: email\n      - podSelector:\n          matchLabels:\n            app: currency\n      - namespaceSelector:\n          matchLabels:\n            name: adservice\n        podSelector:\n          matchLabels:\n            app: adservice\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-ad-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"adservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T19:45:57Z\"\n    generation: 10\n    name: deny-ad-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"86164\"\n    uid: bf773c50-50f9-4fb2-806d-2e34948ad599\n  spec:\n    egress:\n    - ports:\n      - port: 9555\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: adservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: adservice\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-adservice-to-checkoutservice\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"adservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T21:27:36Z\"\n    generation: 2\n    name: deny-adservice-to-checkoutservice\n    namespace: checkoutservice\n    resourceVersion: \"82703\"\n    uid: 3c7bdd35-7e44-4a32-9352-021f09c51594\n  spec:\n    ingress:\n    - ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-all-ingress-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T11:45:36Z\"\n    generation: 15\n    name: deny-all-ingress-checkout\n    namespace: checkoutservice\n    resourceVersion: \"82304\"\n    uid: 41c4a56d-e5d9-418b-b2a8-2680b3e3b23e\n  spec:\n    egress:\n    - ports:\n      - port: 7070\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-cart-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"cartservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T19:46:01Z\"\n    generation: 1\n    name: deny-cart-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"74006\"\n    uid: e4a68616-5a71-4bec-aece-0f0aba0bb43a\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: cartservice\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-productcatalog-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"productcatalogservice\"}}}],\"ports\":[{\"port\":5050}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T11:45:32Z\"\n    generation: 1\n    name: deny-productcatalog-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"34445\"\n    uid: b9508333-8263-4000-a400-0c2a6ca21c09\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: productcatalogservice\n      ports:\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-recommendation-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"recommendationservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}}\n    creationTimestamp: \"2025-04-26T13:00:47Z\"\n    generation: 7\n    name: deny-recommendation-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"90827\"\n    uid: e99e9682-85d8-4761-bc92-4ecb1ae02bc9\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: recommendationservice\n      ports:\n      - port: 8080\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-shipping-to-checkout\",\"namespace\":\"checkoutservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"shippingservice\"}}}],\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T11:46:00Z\"\n    generation: 11\n    name: deny-shipping-to-checkout\n    namespace: checkoutservice\n    resourceVersion: \"90770\"\n    uid: fe4752a4-613e-446b-860e-50d7fa7c6d78\n  spec:\n    egress:\n    - ports:\n      - port: 5050\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      - podSelector:\n          matchLabels:\n            app: shippingservice\n      ports:\n      - port: 5050\n        protocol: TCP\n      - port: 5050\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: checkoutservice\n    policyTypes:\n    - Ingress\nkind: List\nmetadata:\n  resourceVersion: \"\"\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl patch networkpolicy allow-checkout-to-email -n checkoutservice --type='json' -p='[{\"op\": \"replace\", \"path\": \"/spec/egress\", \"value\": [{\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]}]}]'",
        "output": "networkpolicy.networking.k8s.io/allow-checkout-to-email patched\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl get networkpolicy -n emailservice -o yaml",
        "output": "apiVersion: v1\nitems:\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-egress-to-payment\",\"namespace\":\"emailservice\"},\"spec\":{\"egress\":[{\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}},\"policyTypes\":[\"Egress\"]}}\n    creationTimestamp: \"2025-04-26T15:26:34Z\"\n    generation: 1\n    name: deny-egress-to-payment\n    namespace: emailservice\n    resourceVersion: \"52975\"\n    uid: 2a7bcf6a-8ce0-4529-9ab3-6ff72d71f82f\n  spec:\n    egress:\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-frontend-access\",\"namespace\":\"emailservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"frontend\"}}}]}],\"podSelector\":{},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T21:21:30Z\"\n    generation: 3\n    name: deny-frontend-access\n    namespace: emailservice\n    resourceVersion: \"91190\"\n    uid: 32e57b65-4537-41f3-a3c2-3e446d3c9083\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: frontend\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector: {}\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"deny-frontend-to-emailservice\",\"namespace\":\"emailservice\"},\"spec\":{\"ingress\":[],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T21:21:41Z\"\n    generation: 2\n    name: deny-frontend-to-emailservice\n    namespace: emailservice\n    resourceVersion: \"81901\"\n    uid: ad96ba1c-fff0-48fa-9512-d954c1640124\n  spec:\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"emailservice\",\"namespace\":\"emailservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"frontend\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"checkout\"}}}],\"ports\":[{\"port\":5000,\"protocol\":\"TCP\"}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}}\n    creationTimestamp: \"2025-04-26T06:10:08Z\"\n    generation: 62\n    name: emailservice\n    namespace: emailservice\n    resourceVersion: \"91000\"\n    uid: 5dba4873-8f7c-468b-923e-e98fba5cfe08\n  spec:\n    egress:\n    - ports:\n      - port: 5000\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: checkoutservice\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: checkoutservice\n      ports:\n      - port: 5000\n        protocol: TCP\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Ingress\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"emailservice-deny-frontend\",\"namespace\":\"emailservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T05:58:03Z\"\n    generation: 5\n    name: emailservice-deny-frontend\n    namespace: emailservice\n    resourceVersion: \"5788\"\n    uid: f9ab4980-7260-4d27-9c30-8ba93799bdbf\n  spec:\n    ingress:\n    - {}\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"emailservice-deny-unexpected\",\"namespace\":\"emailservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T05:58:34Z\"\n    generation: 22\n    name: emailservice-deny-unexpected\n    namespace: emailservice\n    resourceVersion: \"72855\"\n    uid: e190b3b9-cc26-4949-aeda-dbfb7b973e32\n  spec:\n    ingress:\n    - {}\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Ingress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"emailservice-policy\",\"namespace\":\"emailservice\"},\"spec\":{\"egress\":[{\"ports\":[{\"port\":5050,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"checkoutservice\"}}}]},{\"ports\":[{\"port\":50051,\"protocol\":\"TCP\"}],\"to\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"paymentservice\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}},\"policyTypes\":[\"Ingress\",\"Egress\"]}}\n    creationTimestamp: \"2025-04-26T08:12:59Z\"\n    generation: 110\n    name: emailservice-policy\n    namespace: emailservice\n    resourceVersion: \"88855\"\n    uid: 41e37ede-2430-4607-a357-571a4bd97800\n  spec:\n    egress:\n    - ports:\n      - port: 50051\n        protocol: TCP\n      to:\n      - podSelector:\n          matchLabels:\n            app: paymentservice\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Ingress\n    - Egress\n- apiVersion: networking.k8s.io/v1\n  kind: NetworkPolicy\n  metadata:\n    annotations:\n      kubectl.kubernetes.io/last-applied-configuration: |\n        {\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"restrict-emailservice-ingress\",\"namespace\":\"emailservice\"},\"spec\":{\"ingress\":[{\"from\":[{\"podSelector\":{\"matchLabels\":{\"app\":\"checkout\"}}},{\"podSelector\":{\"matchLabels\":{\"app\":\"shipping\"}}}]}],\"podSelector\":{\"matchLabels\":{\"app\":\"emailservice\"}},\"policyTypes\":[\"Ingress\"]}}\n    creationTimestamp: \"2025-04-26T21:21:47Z\"\n    generation: 1\n    name: restrict-emailservice-ingress\n    namespace: emailservice\n    resourceVersion: \"81894\"\n    uid: cd2c0ef7-c898-4c59-8506-01e7ccaf92fb\n  spec:\n    ingress:\n    - from:\n      - podSelector:\n          matchLabels:\n            app: checkout\n      - podSelector:\n          matchLabels:\n            app: shipping\n    podSelector:\n      matchLabels:\n        app: emailservice\n    policyTypes:\n    - Ingress\nkind: List\nmetadata:\n  resourceVersion: \"\"\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    },
    {
        "llm_command": "kubectl patch networkpolicy emailservice-policy -n emailservice --type='json' -p='[{\"op\": \"add\", \"path\": \"/spec/ingress/-\", \"value\": {\"from\": [{\"podSelector\": {\"matchLabels\": {\"app\": \"checkoutservice\"}}}], \"ports\": [{\"port\": 5000, \"protocol\": \"TCP\"}]}}]'",
        "output": "The request is invalid: the server rejected our request due to an error in our request\n",
        "mismatch_summary": "Mismatch: checkoutservice \u2192 emailservice:5000 (Expected: True, Actual: False)\nMismatch: productcatalogservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: recommendationservice \u2192 cartservice:7070 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: shippingservice \u2192 paymentservice:50051 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 checkoutservice:5050 (Expected: False, Actual: True)\nMismatch: emailservice \u2192 paymentservice:50051 (Expected: False, Actual: True)"
    }
]